E rot and rot: 400点

[問題文]
(10^9 + 7)個の石が円形に並べられています。
適当な石をスタート地点としてそこから順に時計回りに0, 1, 2, ..., (10^9 + 6)と番号を振りました。
ここでその中のS番の石の上にコマを置き、そのコマに対し次の操作を行うことを考えます。
1. コマの現在地の番号をA倍した数値分前に進める。
2. コマをBだけ前に進める。
これらの操作をN回行った時最終的にコマはどの番号の石に置かれているか求めてください。

[制約]
・入力は全て整数
・0 <= S < (10^9 + 7)
・0 <= A, B <= 10^9
・1 <= N <= 10^9

[入力]
入力は以下の形式で標準入力から与えられる。
----------
S
A B
N
----------
一行目にコマを最初に置く石の番号Sが与えられる。
続く行にコマに対して行う操作に関連するパラメータA及びBが与えられる。
最後の行に操作の試行回数Nが与えられる。

[出力]
最終的なコマの位置を出力せよ。

[入力例1]
----------
0
1 1000000000
2
----------

[出力例1]
----------
999999986
----------
コマは0番からスタートする。
Aの値は1なので最初の操作では1000000000だけ前に進むので1000000000番にコマは存在する。
次の操作でコマの位置を1倍したマスだけ進むので1000000000進み、さらにBだけすすむのでまた1000000000だけ進むので二周回って最終的に999999986番にいることになる。

[入力例2]
----------
3
2 5
3
----------

[出力例2]
----------
146
----------
